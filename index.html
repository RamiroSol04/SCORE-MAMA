<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Score MAMÁ</title>
<script src="https://cdn.tailwindcss.com"></script>
<!-- Aquí agregamos el enlace a nuestro archivo de manifiesto -->
<link rel="manifest" href="/manifest.json">
<style>
body {
background-color: #f3f4f6;
font-family: 'Inter', sans-serif;
}
input[type="number"] {
-moz-appearance: textfield;
}
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
-webkit-appearance: none;
margin: 0;
}
.score-rojo {
background-color: #ef4444; /* red-500 */
}
.score-amarillo {
background-color: #f59e0b; /* amber-500 */
}
.score-azul {
background-color: #60a5fa; /* light blue-400 */
}
</style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

<div class="bg-white rounded-xl shadow-lg p-6 max-w-lg w-full">
<div class="text-center mb-6">
<!-- Título de la aplicación -->
<h1 class="text-3xl font-bold text-gray-800">Calculadora Score MAMÁ</h1>
<p class="text-gray-600 mt-1">Ingresa los valores para obtener la puntuación.</p>
</div>

<!-- Imagen de una mujer embarazada -->
<div class="text-center mb-6">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-blue-500 mx-auto mb-4">
<path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.5 14.5a.75.75 0 00-1.5 0v.75H10.5a.75.75 0 000 1.5h1.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5h1.25a.75.75 0 000-1.5h-1.5v-.75zM8.25 9a3.75 3.75 0 017.5 0v1.5a.75.75 0 001.5 0V9a5.25 5.25 0 00-10.5 0v1.5a.75.75 0 001.5 0V9z" clip-rule="evenodd" />
</svg>
</div>
<!-- Contenedor para los campos de entrada -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">

<!-- Frecuencia Cardíaca -->
<div>
<label for="fc" class="block text-sm font-medium text-gray-700">Frecuencia Cardíaca (lpm)</label>
<input type="number" id="fc" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 80">
</div>

<!-- Presión Arterial Sistólica -->
<div>
<label for="pas" class="block text-sm font-medium text-gray-700">Presión Arterial Sistólica (mmHg)</label>
<input type="number" id="pas" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 120">
</div>

<!-- Presión Arterial Diastólica -->
<div>
<label for="pad" class="block text-sm font-medium text-gray-700">Presión Arterial Diastólica (mmHg)</label>
<input type="number" id="pad" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 80">
</div>

<!-- Frecuencia Respiratoria -->
<div>
<label for="fr" class="block text-sm font-medium text-gray-700">Frecuencia Respiratoria (rpm)</label>
<input type="number" id="fr" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 18">
</div>

<!-- Temperatura °C -->
<div>
<label for="temp" class="block text-sm font-medium text-gray-700">Temperatura (°C)</label>
<input type="number" id="temp" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 37.0" step="0.1">
</div>
<!-- Saturación de O2 -->
<div>
<label for="satO2" class="block text-sm font-medium text-gray-700">Saturación de O2 (%)</label>
<input type="number" id="satO2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" placeholder="Ej. 98">
</div>

<!-- Nivel de Conciencia -->
<div>
<label for="conciencia" class="block text-sm font-medium text-gray-700">Nivel de Conciencia</label>
<select id="conciencia" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
<option value="0">Alerta (0)</option>
<option value="1">Somnolienta (1)</option>
  <option value="2">Responde al dolor (2)</option>
<option value="2">Confusa (2)</option>
<option value="3">Inconsciente (3)</option>
</select>
</div>

<!-- Proteinuria -->
<div>
<label for="proteinuria" class="block text-sm font-medium text-gray-700">Proteinuria</label>
<select id="proteinuria" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
<option value="0">0 cruces (0)</option>
<option value="1">+ (1)</option>
</select>
</div>
</div>

<!-- Botón para calcular -->
<div class="text-center">
<button onclick="calcularScore()" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition duration-300 transform hover:scale-105">
Calcular Puntuación
</button>
</div>

<!-- Sección de resultados -->
<div id="resultado" class="mt-6 p-4 rounded-lg text-center font-bold text-white hidden">
<p id="puntuacionTotal" class="text-2xl"></p>
<p id="interpretacion" class="text-lg mt-2"></p>
<div id="instrucciones" class="text-left text-sm mt-4 text-white"></div>
</div>

</div>

<script>
// Registramos el Service Worker para la funcionalidad de PWA
if ('serviceWorker' in navigator) {
window.addEventListener('load', () => {
navigator.serviceWorker.register('/service-worker.js')
.then(registration => {
console.log('Service Worker registrado con éxito:', registration);
})
.catch(error => {
console.log('Fallo al registrar Service Worker:', error);
});
});
}

// Esta es la parte de la "magia" que hace el cálculo
function calcularScore() {
// 1. Obtenemos los valores que el usuario ingresó
const fc = parseFloat(document.getElementById('fc').value);
const pas = parseFloat(document.getElementById('pas').value);
const pad = parseFloat(document.getElementById('pad').value);
const fr = parseFloat(document.getElementById('fr').value);
const temp = parseFloat(document.getElementById('temp').value);
const satO2 = parseFloat(document.getElementById('satO2').value);
const conciencia = parseInt(document.getElementById('conciencia').value);
const proteinuria = parseInt(document.getElementById('proteinuria').value);

let totalScore = 0;

// 2. Aquí es donde se aplican las reglas para el cálculo del score,
// basadas en las tablas del documento que subiste.

// Puntuación para Frecuencia Cardíaca
if (fc >= 120) totalScore += 3;
else if (fc >= 111 && fc < 119) totalScore += 2;
  else if (fc >= 101 && fc < 110) totalScore += 1;
else if (fc >= 51 && fc < 59) totalScore += 1;
  if (fc <= 50) totalScore += 3;
// Puntuación para Presión Arterial Sistólica
if (pas >= 160) totalScore += 3;
else if (pas >= 140 && pas < 159) totalScore += 2;
else if (pas >= 71 && pas < 89) totalScore += 2;
else if (pas < 70) totalScore += 3;

// Puntuación para Presión Arterial Diastólica
if (pad >= 110) totalScore += 3;
else if (pad >= 90 && pad < 109) totalScore += 2;
  else if (pad >= 86 && pad < 89) totalScore += 1;
  else if (pad >= 51 && pad < 59) totalScore += 2;
  if (pad  <= 50) totalScore += 3;

// Puntuación para Frecuencia Respiratoria
if (fr >= 30) totalScore += 3;
else if (fr >= 23 && fr < 29) totalScore += 2;
else if (fr < 11) totalScore += 3;

// Puntuación para Temperatura
if (temp >= 38.5) totalScore += 3;
  else if (temp >= 37.6 && temp < 38.4) totalScore += 1;
else if (temp < 35.5) totalScore += 2;

// Puntuación para Saturación de O2
if (satO2 < 85) totalScore += 3;
  else if (satO2 >= 86 && satO2 < 89) totalScore += 2;
   else if (satO2 >= 90 && satO2 < 93) totalScore += 1;

// Puntuación para Nivel de Conciencia (ya viene del select)
totalScore += conciencia;

// Puntuación para Proteinuria (ya viene del select)
totalScore += proteinuria;
// 3. Mostramos el resultado en la pantalla
const resultadoDiv = document.getElementById('resultado');
const puntuacionTotalP = document.getElementById('puntuacionTotal');
const interpretacionP = document.getElementById('interpretacion');
const instruccionesDiv = document.getElementById('instrucciones');

puntuacionTotalP.textContent = `Puntuación Total: ${totalScore}`;
resultadoDiv.classList.remove('hidden');
resultadoDiv.classList.remove('score-rojo', 'score-amarillo', 'score-azul');
instruccionesDiv.innerHTML = ''; // Limpiar las instrucciones anteriores

// 4. Asignamos color, interpretación y agregamos instrucciones según el puntaje
if (totalScore >= 7) {
resultadoDiv.classList.add('score-rojo');
interpretacionP.textContent = "Clave Roja: Alerta máxima. Se requiere manejo inmediato."
instruccionesDiv.innerHTML = `
<ul class="list-disc list-inside text-sm mt-2">
<li>Activar protocolo de Clave Roja.</li>
<li>Llamar a más personal de acuerdo al requerimiento.</li>
<li>Asistir al coordinador del equipo en procedimientos.</li>
<li>Reevaluar el Score MAMÁ cada 30 minutos.</li>
</ul>
`;
} else if (totalScore >= 4) {
resultadoDiv.classList.add('score-amarillo');
interpretacionP.textContent = "Clave Amarilla: Alto riesgo. Requiere valoración urgente."
instruccionesDiv.innerHTML = `
<ul class="list-disc list-inside text-sm mt-2">
<li>Activar protocolo de Clave Amarilla.</li>
<li>Informar a médico de forma inmediata.</li>
<li>Reevaluar el Score MAMÁ cada 30 minutos.</li>
<li>Considerar la transferencia a un nivel de mayor complejidad.</li>
</ul>
`;
} else {
resultadoDiv.classList.add('score-azul');
interpretacionP.textContent = "Posible Clave Azul: Bajo riesgo. Continúe con la evaluación de rutina."
instruccionesDiv.innerHTML = `
<ul class="list-disc list-inside text-sm mt-2">
<li>Continuar con la evaluación y control de rutina.</li>
<li>Reevaluar el Score MAMÁ cada 1 horas.</li>
<li>Informar al médico tratante si hay algún cambio.</li>
</ul>
`;
}
}
</script>
</body>
</html>
